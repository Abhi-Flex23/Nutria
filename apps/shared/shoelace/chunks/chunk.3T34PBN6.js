import{b as T,c as k,d as M,e as L,f as C,g as A}from"./chunk.SODMG5GV.js";import{a as I}from"./chunk.NMU3HIAL.js";import{a as O}from"./chunk.OXXM3YXE.js";import{c as P}from"./chunk.PYPBGY2O.js";import{a as m,c as u}from"./chunk.F64FS4SB.js";import{a as f,c as g}from"./chunk.O7L2VUC4.js";import{h as v}from"./chunk.RLLTRZYL.js";import{a as E}from"./chunk.PC5WGFOA.js";import{a as l}from"./chunk.OSEV3RCT.js";import{a as h,b as c}from"./chunk.V4OMSSO6.js";import{a as b,b as a,d as p}from"./chunk.GVR6SJVE.js";import{c as y,h as w}from"./chunk.7EIHAL55.js";import{g as s}from"./chunk.OAQCUA7X.js";var i=class extends w{constructor(){super(...arguments);this.localize=new v(this);this.open=!1;this.placement="bottom-start";this.disabled=!1;this.stayOpenOnSelect=!1;this.distance=0;this.skidding=0;this.hoist=!1}connectedCallback(){super.connectedCallback(),this.handleMenuItemActivate=this.handleMenuItemActivate.bind(this),this.handlePanelSelect=this.handlePanelSelect.bind(this),this.handleDocumentKeyDown=this.handleDocumentKeyDown.bind(this),this.handleDocumentMouseDown=this.handleDocumentMouseDown.bind(this),this.containingElement||(this.containingElement=this)}async firstUpdated(){this.panel.hidden=!this.open,this.open&&(await this.updateComplete,this.addOpenListeners(),this.startPositioner())}disconnectedCallback(){super.disconnectedCallback(),this.removeOpenListeners(),this.hide(),this.stopPositioner()}focusOnTrigger(){let t=this.trigger.querySelector("slot").assignedElements({flatten:!0})[0];typeof(t==null?void 0:t.focus)=="function"&&t.focus()}getMenu(){return this.panel.querySelector("slot").assignedElements({flatten:!0}).find(t=>t.tagName.toLowerCase()==="sl-menu")}handleDocumentKeyDown(e){var t;if(e.key==="Escape"){this.hide(),this.focusOnTrigger();return}if(e.key==="Tab"){if(this.open&&((t=document.activeElement)==null?void 0:t.tagName.toLowerCase())==="sl-menu-item"){e.preventDefault(),this.hide(),this.focusOnTrigger();return}setTimeout(()=>{var o,r,d;let n=((o=this.containingElement)==null?void 0:o.getRootNode())instanceof ShadowRoot?(d=(r=document.activeElement)==null?void 0:r.shadowRoot)==null?void 0:d.activeElement:document.activeElement;(!this.containingElement||(n==null?void 0:n.closest(this.containingElement.tagName.toLowerCase()))!==this.containingElement)&&this.hide()})}}handleDocumentMouseDown(e){let t=e.composedPath();this.containingElement&&!t.includes(this.containingElement)&&this.hide()}handleMenuItemActivate(e){let t=e.target;P(t,this.panel)}handlePanelSelect(e){let t=e.target;!this.stayOpenOnSelect&&t.tagName.toLowerCase()==="sl-menu"&&(this.hide(),this.focusOnTrigger())}handlePopoverOptionsChange(){this.updatePositioner()}handleTriggerClick(){this.open?this.hide():this.show()}handleTriggerKeyDown(e){if(e.key==="Escape"){this.focusOnTrigger(),this.hide();return}if([" ","Enter"].includes(e.key)){e.preventDefault(),this.handleTriggerClick();return}let t=this.getMenu();if(t){let n=t.defaultSlot.assignedElements({flatten:!0}),o=n[0],r=n[n.length-1];["ArrowDown","ArrowUp","Home","End"].includes(e.key)&&(e.preventDefault(),this.open||this.show(),n.length>0&&requestAnimationFrame(()=>{(e.key==="ArrowDown"||e.key==="Home")&&(t.setCurrentItem(o),o.focus()),(e.key==="ArrowUp"||e.key==="End")&&(t.setCurrentItem(r),r.focus())}));let d=["Tab","Shift","Meta","Ctrl","Alt"];this.open&&!d.includes(e.key)&&t.typeToSelect(e)}}handleTriggerKeyUp(e){e.key===" "&&e.preventDefault()}handleTriggerSlotChange(){this.updateAccessibleTrigger()}updateAccessibleTrigger(){let n=this.trigger.querySelector("slot").assignedElements({flatten:!0}).find(r=>O(r).start),o;if(n){switch(n.tagName.toLowerCase()){case"sl-button":case"sl-icon-button":o=n.button;break;default:o=n}o.setAttribute("aria-haspopup","true"),o.setAttribute("aria-expanded",this.open?"true":"false")}}async show(){if(!this.open)return this.open=!0,c(this,"sl-after-show")}async hide(){if(!!this.open)return this.open=!1,c(this,"sl-after-hide")}reposition(){this.updatePositioner()}addOpenListeners(){this.panel.addEventListener("sl-activate",this.handleMenuItemActivate),this.panel.addEventListener("sl-select",this.handlePanelSelect),document.addEventListener("keydown",this.handleDocumentKeyDown),document.addEventListener("mousedown",this.handleDocumentMouseDown)}removeOpenListeners(){this.panel.removeEventListener("sl-activate",this.handleMenuItemActivate),this.panel.removeEventListener("sl-select",this.handlePanelSelect),document.removeEventListener("keydown",this.handleDocumentKeyDown),document.removeEventListener("mousedown",this.handleDocumentMouseDown)}async handleOpenChange(){if(this.disabled){this.open=!1;return}if(this.updateAccessibleTrigger(),this.open){h(this,"sl-show"),this.addOpenListeners(),await u(this),this.startPositioner(),this.panel.hidden=!1;let{keyframes:e,options:t}=g(this,"dropdown.show",{dir:this.localize.dir()});await m(this.panel,e,t),h(this,"sl-after-show")}else{h(this,"sl-hide"),this.removeOpenListeners(),await u(this);let{keyframes:e,options:t}=g(this,"dropdown.hide",{dir:this.localize.dir()});await m(this.panel,e,t),this.panel.hidden=!0,this.stopPositioner(),h(this,"sl-after-hide")}}startPositioner(){this.stopPositioner(),this.updatePositioner(),this.positionerCleanup=C(this.trigger,this.positioner,this.updatePositioner.bind(this))}updatePositioner(){!this.open||!this.trigger||!this.positioner||A(this.trigger,this.positioner,{placement:this.placement,middleware:[k({mainAxis:this.distance,crossAxis:this.skidding}),T(),M(),L({apply:({availableWidth:e,availableHeight:t})=>{Object.assign(this.panel.style,{maxWidth:`${e}px`,maxHeight:`${t}px`})}})],strategy:this.hoist?"fixed":"absolute"}).then(({x:e,y:t,placement:n})=>{this.positioner.setAttribute("data-placement",n),Object.assign(this.positioner.style,{position:this.hoist?"fixed":"absolute",left:`${e}px`,top:`${t}px`})})}stopPositioner(){this.positionerCleanup&&(this.positionerCleanup(),this.positionerCleanup=void 0,this.positioner.removeAttribute("data-placement"))}render(){return y`
      <div
        part="base"
        id="dropdown"
        class=${E({dropdown:!0,"dropdown--open":this.open})}
      >
        <span
          part="trigger"
          class="dropdown__trigger"
          @click=${this.handleTriggerClick}
          @keydown=${this.handleTriggerKeyDown}
          @keyup=${this.handleTriggerKeyUp}
        >
          <slot name="trigger" @slotchange=${this.handleTriggerSlotChange}></slot>
        </span>

        <!-- Position the panel with a wrapper since the popover makes use of translate. This let's us add animations
        on the panel without interfering with the position. -->
        <div class="dropdown__positioner">
          <div
            part="panel"
            class="dropdown__panel"
            aria-hidden=${this.open?"false":"true"}
            aria-labelledby="dropdown"
          >
            <slot></slot>
          </div>
        </div>
      </div>
    `}};i.styles=I,s([p(".dropdown__trigger")],i.prototype,"trigger",2),s([p(".dropdown__panel")],i.prototype,"panel",2),s([p(".dropdown__positioner")],i.prototype,"positioner",2),s([a({type:Boolean,reflect:!0})],i.prototype,"open",2),s([a({reflect:!0})],i.prototype,"placement",2),s([a({type:Boolean,reflect:!0})],i.prototype,"disabled",2),s([a({attribute:"stay-open-on-select",type:Boolean,reflect:!0})],i.prototype,"stayOpenOnSelect",2),s([a({attribute:!1})],i.prototype,"containingElement",2),s([a({type:Number})],i.prototype,"distance",2),s([a({type:Number})],i.prototype,"skidding",2),s([a({type:Boolean})],i.prototype,"hoist",2),s([l("distance"),l("hoist"),l("placement"),l("skidding")],i.prototype,"handlePopoverOptionsChange",1),s([l("open",{waitUntilFirstUpdate:!0})],i.prototype,"handleOpenChange",1),i=s([b("sl-dropdown")],i);f("dropdown.show",{keyframes:[{opacity:0,transform:"scale(0.9)"},{opacity:1,transform:"scale(1)"}],options:{duration:100,easing:"ease"}});f("dropdown.hide",{keyframes:[{opacity:1,transform:"scale(1)"},{opacity:0,transform:"scale(0.9)"}],options:{duration:100,easing:"ease"}});export{i as a};
