import{a as d}from"./chunk.OAQCUA7X.js";var h=class extends Event{constructor(o){super("formdata");this.formData=o}},m=class extends FormData{constructor(o){var t=(...args)=>{super(...args)};o?(t(o),this.form=o,o.dispatchEvent(new h(this))):t()}append(o,e){if(!this.form)return super.append(o,e);let i=this.form.elements[o];if(i||(i=document.createElement("input"),i.type="hidden",i.name=o,this.form.appendChild(i)),this.has(o)){let s=this.getAll(o),l=s.indexOf(i.value);l!==-1&&s.splice(l,1),s.push(e),this.set(o,s)}else super.append(o,e);i.value=e}};function c(){let r=document.createElement("form"),t=!1;return document.body.append(r),r.addEventListener("submit",o=>{new FormData(o.target),o.preventDefault()}),r.addEventListener("formdata",()=>t=!0),r.dispatchEvent(new Event("submit",{cancelable:!0})),r.remove(),t}function u(){!window.FormData||c()||(window.FormData=m,window.addEventListener("submit",r=>{r.defaultPrevented||new FormData(r.target)}))}document.readyState==="complete"?u():window.addEventListener("DOMContentLoaded",()=>u());var n=new WeakMap,p=new WeakMap,a=new WeakMap,f=class{constructor(t,o){(this.host=t).addController(this),this.options=d({form:e=>e.closest("form"),name:e=>e.name,value:e=>e.value,defaultValue:e=>e.defaultValue,disabled:e=>{var i;return(i=e.disabled)!=null?i:!1},reportValidity:e=>typeof e.reportValidity=="function"?e.reportValidity():!0,setValue:(e,i)=>e.value=i},o),this.handleFormData=this.handleFormData.bind(this),this.handleFormSubmit=this.handleFormSubmit.bind(this),this.handleFormReset=this.handleFormReset.bind(this),this.reportFormValidity=this.reportFormValidity.bind(this),this.handleUserInput=this.handleUserInput.bind(this)}hostConnected(){this.form=this.options.form(this.host),this.form&&(n.has(this.form)?n.get(this.form).add(this.host):n.set(this.form,new Set([this.host])),this.form.addEventListener("formdata",this.handleFormData),this.form.addEventListener("submit",this.handleFormSubmit),this.form.addEventListener("reset",this.handleFormReset),a.has(this.form)||(a.set(this.form,this.form.reportValidity),this.form.reportValidity=()=>this.reportFormValidity())),this.host.addEventListener("sl-input",this.handleUserInput)}hostDisconnected(){var t;this.form&&((t=n.get(this.form))==null||t.delete(this.host),this.form.removeEventListener("formdata",this.handleFormData),this.form.removeEventListener("submit",this.handleFormSubmit),this.form.removeEventListener("reset",this.handleFormReset),a.has(this.form)&&(this.form.reportValidity=a.get(this.form),a.delete(this.form)),this.form=void 0),this.host.removeEventListener("sl-input",this.handleUserInput)}hostUpdated(){var s;let t=this.host,o=Boolean(p.get(t)),e=Boolean(t.invalid),i=Boolean(t.required);(s=this.form)!=null&&s.noValidate?(t.removeAttribute("data-required"),t.removeAttribute("data-optional"),t.removeAttribute("data-invalid"),t.removeAttribute("data-valid"),t.removeAttribute("data-user-invalid"),t.removeAttribute("data-user-valid")):(t.toggleAttribute("data-required",i),t.toggleAttribute("data-optional",!i),t.toggleAttribute("data-invalid",e),t.toggleAttribute("data-valid",!e),t.toggleAttribute("data-user-invalid",e&&o),t.toggleAttribute("data-user-valid",!e&&o))}handleFormData(t){let o=this.options.disabled(this.host),e=this.options.name(this.host),i=this.options.value(this.host),s=this.host.tagName.toLowerCase()==="sl-button";!o&&!s&&typeof e=="string"&&typeof i!="undefined"&&(Array.isArray(i)?i.forEach(l=>{t.formData.append(e,l.toString())}):t.formData.append(e,i.toString()))}handleFormSubmit(t){var i;let o=this.options.disabled(this.host),e=this.options.reportValidity;this.form&&!this.form.noValidate&&((i=n.get(this.form))==null||i.forEach(s=>{this.setUserInteracted(s,!0)})),this.form&&!this.form.noValidate&&!o&&!e(this.host)&&(t.preventDefault(),t.stopImmediatePropagation())}handleFormReset(){this.options.setValue(this.host,this.options.defaultValue(this.host)),this.setUserInteracted(this.host,!1)}async handleUserInput(){await this.host.updateComplete,this.setUserInteracted(this.host,!0)}reportFormValidity(){if(this.form&&!this.form.noValidate){let t=this.form.querySelectorAll("*");for(let o of t)if(typeof o.reportValidity=="function"&&!o.reportValidity())return!1}return!0}setUserInteracted(t,o){p.set(t,o),t.requestUpdate()}doAction(t,o){if(this.form){let e=document.createElement("button");e.type=t,e.style.position="absolute",e.style.width="0",e.style.height="0",e.style.clipPath="inset(50%)",e.style.overflow="hidden",e.style.whiteSpace="nowrap",o&&(e.name=o.name,e.value=o.value,["formaction","formenctype","formmethod","formnovalidate","formtarget"].forEach(i=>{o.hasAttribute(i)&&e.setAttribute(i,o.getAttribute(i))})),this.form.append(e),e.click(),e.remove()}}reset(t){this.doAction("reset",t)}submit(t){this.doAction("submit",t)}};export{f as a};
